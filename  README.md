# –î–æ–º–∞—à–Ω—è—è —Ä–∞–±–æ—Ç–∞ –ø–æ REST API (–ñ–î –±–∏–ª–µ—Ç—ã)
***
### –ì–ª–∞–≤—ã
I. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è  
II. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö  

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è 
***
##### –ó–∞–ø—Ä–æ—Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø–æ–µ–∑–¥–æ–≤ –ø–æ –º–∞—Ä—à—Ä—É—Ç—É –õ–∏–ø–µ—Ü–∫-–ú–æ—Å–∫–≤–∞ –Ω–∞ —Ç–∏–ø–µ –ø–æ–µ–∑–¥–∞ –ü–æ–±–µ–¥–∞ (GET):
`http://localhost:8080/schedule?arrival=–õ–∏–ø–µ—Ü–∫&departure=–ú–æ—Å–∫–≤–∞&train=–ü–æ–±–µ–¥–∞`

–í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ String.  
–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞:
```json
[
{
"id_route": 1,
"type_train": "–ü–æ–±–µ–¥–∞",
"name_departure": "–õ–∏–ø–µ—Ü–∫",
"time_departure": "2023-08-26T21:25:00.000+00:00",
"id_time_departure": 27,
"name_arrival": "–ú–æ—Å–∫–≤–∞",
"time_arrival": "2023-08-27T08:07:00.000+00:00",
"id_time_arrival": 33
}
]
``````
>–ö–æ–¥: 200 OK 
>
| –ü–æ–ª–µ              | –¢–∏–ø          |
|-------------------|--------------|
| id_route          | Long         |
| type_train        | String       |
| name_departure    | String       |
| time_departure    | TimeStampz   |
| id_time_departure | Long         |
| name_arrival      | String       |
| time_arrival      | TimeStampz   |
| id_time_arrival   | Long         |



–í–∞—Ä–∏–∞–Ω—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –æ—à–∏–±–æ–∫:
1. –û—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –ë–î. 
_–≠—Ç–∞ –æ—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –∏ –≤ –¥—Ä—É–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –ø–æ—ç—Ç–æ–º—É –ø–æ–≤—Ç–æ—Ä—è—Ç—å –µ—ë –Ω–µ –±—É–¥–µ–º_
```json
{
    "error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –≤ –ë–î",
    "debugMessage": "Failed to obtain JDBC Connection"
}
``````
> –ö–æ–¥: 500 Internal Server Error
>

2. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ:
```json
{
    "error": "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
}
``````
>–ö–æ–¥: 404 Not Found
##### –ó–∞–ø—Ä–æ—Å –Ω–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –±–∏–ª–µ—Ç–æ–≤ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π (GET):
_–¢–æ –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–æ –≤ –ø—É–Ω–∫—Ç–µ II._

`http://localhost:8080/ticket?client=1&departure=1&arrival=5&placeList=6,7&personList=4,5`

| Key         | Value | Type  | –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                                      |
|-------------|-------|-------|----------------------------------------------------------------|
| client      | 1     | Long  | __id –∫–ª–∏–µ–Ω—Ç–∞__ - —Ç–æ—Ç –∫—Ç–æ –ø–æ–∫—É–ø–∞–µ—Ç –±–∏–ª–µ—Ç                        |
| departure   | 1     | Long  | __id —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Ç–æ—á–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ__ - —Ç–æ –æ—Ç–∫—É–¥–∞ –∏ –∫–æ–≥–¥–∞ –ø–æ–µ–¥—É—Ç |
| arrival     | 5     | Long  | __id —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Ç–æ—á–∫–∏ –ø—Ä–∏–±—ã—Ç–∏—è__ - —Ç–æ –∫—É–¥–∞ –∏ –∫–æ–≥–¥–∞ –ø–æ–µ–¥—É—Ç      |
| placeList   | 4,5   | Long  | __id –º–µ—Å—Ç–∞__ - –º–µ—Å—Ç–æ(–∞) –∫–æ—Ç–æ—Ä–æ–µ(—ã–µ) —Ö–æ—Ç—è—Ç –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏           |
| personList  | 6,7   | Long  | __id —á–µ–ª–æ–≤–µ–∫–∞__ - –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫                   |
```json
[
    {
        "bookingId": 16,
        "boughtplaceId": 36
    },
    {
        "bookingId": 16,
        "boughtplaceId": 37
    }
]
``````
> –ö–æ–¥ 200 OK  
>
–í–æ–∑–≤–∞—Ä—â–∞–µ—Ç id –±–∏–ª–µ—Ç–∞ –∏ id –∫—É–ø–ª–µ–Ω–Ω–æ–≥–æ –º–µ—Å—Ç–∞. –û–±–∞ –∑–Ω–∞—á–µ–Ω–∏—è –∏–º–µ—é —Ç–∏–ø Long

–í–∞—Ä–∏–∞–Ω—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –æ—à–∏–±–æ–∫:
1. –û—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –ë–î. _–û–ø–∏—Å–∞–Ω–∞ –≤—ã—à–µ._
2. –ú–µ—Å—Ç–∞ —É–∂–µ –∫—É–ø–ª–µ–Ω—ã.
```json
   {
   "error": "–ú–µ—Å—Ç–∞ —É–∂–µ –∫—É–ø–ª–µ–Ω—ã"
   }
``````
> –ö–æ–¥: 400 Bad Request
3. –í —Å–ª—É—á–∞–µ —É–∫–∞–∑–∞–Ω–∏—è –º–µ—Å—Ç –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤–µ—Ä–Ω—ë—Ç—Å—è –∫–æ–¥ 500, error 
–æ–± –æ—à–∏–±–∫–µ –ë–î –∏ debugMessage —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –¥–µ—Ç–∞–ª—è—Ö.  
_–í–æ–∑–º–æ–∂–Ω–æ —Å—Ç–æ–∏—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –µ—ë –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å.
–ù–æ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è —ç—Ç–∞ –æ—à–∏–±–∫–∞ –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º–∞ (–∞ –∏–º–µ–Ω–Ω–æ —Ç–æ—Ç –∫—Ç–æ –∫–∏–¥–∞–µ—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –∏ —Ç–∞–∫ —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç –∫–∞–∫–æ–π id —É –¥–∞–Ω–Ω–æ–≥–æ –º–µ—Å—Ç–∞, 
–∞ –µ—Å–ª–∏ –∏ –Ω–µ –∑–Ω–∞–µ—Ç –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, –ø–æ—á–µ–º—É –æ–Ω –µ–≥–æ –Ω–µ –∑–Ω–∞–µ—Ç). 
–ê –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ —É—Å–ª–æ–∂–Ω–µ–Ω–∏—é –∏ —Ç–∞–∫ —Ç—è–∂–µ–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–∞._
#### –ó–∞–ø—Ä–æ—Å –Ω–∞ –æ—Ç–º–µ–Ω—É –±–∏–ª–µ—Ç–∞ (DELETE)
`http://localhost:8080/deletebooking?booking=1`  

–ó–Ω–∞—á–µ–Ω–∏–µ–º booking —è–≤–ª—è–µ—Ç—Å—è id –∑–∞–∫–∞–∑–∞ —Ç–∏–ø Long.
–í–∞—Ä–∏–∞–Ω—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –æ—à–∏–±–æ–∫:
1. –û—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –ë–î. _–û–ø–∏—Å–∞–Ω–∞ –≤—ã—à–µ._
2. –£–∫–∞–∑–∞–Ω id –∑–∞–∫–∞–∑–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –º–µ–Ω–µ–µ 2‚Äë—Ö —á–∞—Å–æ–≤ –¥–æ –≤—ã–µ–∑–¥–∞.
```json
   {
   "error": "–ó–∞–∫–∞–∑ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å"
   }
``````
> –ö–æ–¥: 404 Not Found
>
#### –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö (GET)
`http://localhost:8080/routeStatClientAge?id_route=1&dateFrom=1900-01-01&dateTo=2030-01-01&step=10&maxAge=80`

| Key      | Value      | Type | –ü–æ—è—Å–Ω–µ–Ω–∏–µ                 |
|----------|------------|------|---------------------------|
| id_route | 1          | Long | id –º–∞—Ä—à—Ä—É—Ç–∞               |
| dateFrom | 1900-01-01 | Date | –î–∞—Ç–∞ __–æ—Ç__               |
| dateTo   | 2030-01-01 | Date | –î–∞—Ç–∞ __–¥–æ__               |
| step     | 10         | int  | __–®–∞–≥__  _–ø–æ—è—Å–Ω–µ–Ω–∏–µ –Ω–∏–∂–µ_ |
| maxAge   | 80         | int  | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç      |

–î–æ–ø—É—Å—Ç–∏–º, –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –º–∞—Ä—à—Ä—É—Ç—É —Å id 1 –∑–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ —Å 1900 –ø–æ 2030 –≥–æ–¥.
–¢–∞–∫ –∂–µ –º—ã —Ö–æ—Ç–∏–º —á—Ç–æ–±—ã –ø–∞—Å—Å–∞–∂–∏—Ä—ã –±—ã–ª–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã –≤ –≥—Ä—É–ø–ø—ã —Å —à–∞–≥–æ–º (step) –≤ 5 –ª–µ—Ç. 
–ê –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç (maxAge) 60 –ª–µ—Ç.  
–í—ã–ø–æ–ª–Ω–∏–º –∑–∞–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∏–º:
```json
{
  "0": 0,
  "5": 0,
  "10": 0,
  "15": 0,
  "20": 1,
  "25": 0,
  "30": 0,
  "35": 1,
  "40": 1,
  "45": 2,
  "50": 0,
  "55": 0,
  "other": 1
}
``````
–ö–∞–∫ –º—ã –≤–∏–¥–∏–º –ø–∞—Å—Å–∞–∂–∏—Ä—ã —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã –≤ –≥—Ä—É–ø–ø—ã –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É:  
–ü–∞—Å—Å–∞–∂–∏—Ä—ã –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ –æ—Ç 0 –¥–æ 5 –ª–µ—Ç –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –≥—Ä—É–ø–ø–µ "0", –∞ –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ 
–≥—Ä—É–ø–ø—É 45 (—Ç–æ –µ—Å—Ç—å –ø–∞—Å—Å–∞–∂–∏—Ä—ã –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ 45-50) –≤—Ö–æ–¥–∏—Ç 2 –ø–∞—Å—Å–∞–∂–∏—Ä–∞. –í –≥—Ä—É–ø–ø—É other –≤—Ö–æ–¥—è—Ç –ø–∞—Å—Å–∞–∂–∏—Ä—ã –≤–æ–∑—Ä–∞—Å—Ç 
–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–≤—ã—à–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ maxAge.

–í–∞—Ä–∏–∞–Ω—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –æ—à–∏–±–æ–∫:
1. –û—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –ë–î. _–û–ø–∏—Å–∞–Ω–∞ –≤—ã—à–µ._
2. –ü—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –ë–î –º—ã –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É.
```json
{
"error": "–ù–µ –Ω–∞–π–¥–µ–Ω–æ –ª—é–¥–µ–π –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –º–∞—Ä—à—Ä—É—Ç—É, –∑–∞ –∑–∞–¥–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥"
}
``````
3. –ü—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ –¥–æ–ø—É—Å—Ç–∏–º -1 –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è Step –º—ã –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É.
```json
   {
   "error": "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥—Å—á—ë—Ç–µ, –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ –≤–µ—Ä–Ω—ã–π step –∏–ª–∏ maxAge"
   }
``````
#### –ù–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –≤–∏–¥ –æ—à–∏–±–∫–∏
–í—ã–ø–æ–ª–Ω–∏–º –∑–∞–≤–µ–¥–æ–º–æ –Ω–µ –≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ.  
`http://localhost:8080/deletebooking?booking=–≤—Å–µ—Ö`
 
–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –º—ã –ø–æ–ª—É—á–∏–º —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞ –æ—à–∏–±–∫—É:
```json
{
    "error": "–û—à–∏–±–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è: Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; For input string: \"–≤—Å–µ—Ö\""
}
``````
## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
***

![–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](DataBase/–ø–æ–µ–∑–¥.png)

_–ü–æ—è—Å–Ω—è—Ç—å —Å–≤—è–∑–∏, —Å—É—â–Ω–æ—Å—Ç–∏, –∞—Ç—Ä–∏–±—É—Ç—ã –Ω–µ —Å—Ç–∞–Ω–µ–º. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –∑–∞–π–º—ë—Ç –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —É—Å–Ω—É—Ç—å_ üò¥.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ª–∏—à—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –ë–î. –í—Å–µ –æ–Ω–∏ –Ω—É–∂–Ω—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –±–∏–ª–µ—Ç–∞.  
–ö–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ —Ä–∏—Å—É–Ω–∫–∞ —É —Ç–∞–±–ª–∏—á–∫–∏ "–ó–∞–∫–∞–∑" –µ—Å—Ç—å 3 –∑–∞–≤–∏—Å–∏–º—ã—Ö —Ç–∞–±–ª–∏—á–∫–∏. –≠—Ç–æ "–ö–ª–∏–µ–Ω—Ç" (—Ç–æ—Ç –∫—Ç–æ –ø–æ–∫—É–ø–∞–µ—Ç –±–∏–ª–µ—Ç) –∏ —Ç–∞–±–ª–∏—Ü–∞
"–ö—É–ø–ª–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ". –ù–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è _–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–π –º–æ–∂–Ω–æ –≤ —Ñ–∞–π–ª–µ "DataBase/–±–æ–ª–µ–µ —á–∏—Ç–∞–±–µ–ª—å–Ω—ã–π –±—ç–∫–∞–ø –ë–î"_.  
–≠—Ç–∏ 3 —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –æ–¥–Ω–æ–π –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑-–∑–∞ –¥–≤—É—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤:
1. –í —Ç–∞–±–ª–∏—Ü–µ –ó–∞–∫–∞–∑ –µ—Å—Ç—å –ø–æ–ª–µ id –∫–æ—Ç–æ—Ä–æ–µ –∏–º–µ–µ—Ç —Ç–∏–ø BigSerial, –∞ –∑–Ω–∞—á–∏—Ç –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –°–£–ë–î –≤—ã–¥–∞—Å—Ç id –Ω–∞—à–µ–π –∑–∞–ø–∏—Å–∏.
–î–∞–Ω–Ω—ã–π id –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å 2‚Äë–º –¥—Ä—É–≥–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º —á—Ç–æ–±—ã –∏ –æ–Ω–∏ –º–æ–≥–ª–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å–≤–æ–∏ –ø–æ–ª—è. _–í–æ–∑–º–æ–∂–Ω–æ –µ—Å—Ç—å –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–±, –Ω–æ —è –¥–æ –Ω–µ–≥–æ –Ω–µ –¥–æ–¥—É–º–∞–ª—Å—è._
2. –ù—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –º–µ—Å—Ç–æ –∫—É–ø–ª–µ–Ω–Ω—ã–º.  

–î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏–≤–µ–¥—É –∫–æ–¥ –æ–±—ä–µ–¥–∏–Ω—è—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏:
```
CREATE FUNCTION public.combined_function(id_client bigint, id_arrival_timetable bigint, id_departure_timetable bigint, id_place_arr bigint[], id_person bigint[]) RETURNS TABLE(booking_id bigint, boughtplace_id bigint)
LANGUAGE plpgsql
AS $$
DECLARE
booking_id BIGINT;
boughtplace_ids BIGINT[];
temp_booking_id bigint;
BEGIN
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è
WITH check_places AS (
        SELECT bp.id_place
        FROM boughtplace bp
        JOIN (
        SELECT DISTINCT b.id_booking
        FROM booking b
        JOIN (
        SELECT tim.id_timetable
        FROM timetable ta
        JOIN timetable td ON td.id_timetable = id_arrival_timetable
        JOIN station sa ON ta.id_station = sa.id_station
        JOIN station sd ON td.id_station = sd.id_station
        JOIN station s ON s.serial_number_station BETWEEN sa.serial_number_station AND sd.serial_number_station
        JOIN timetable tim ON tim.id_station = s.id_station
        WHERE ta.id_timetable = id_departure_timetable
        ) sub ON sub.id_timetable = b.id_arrival_timetable OR sub.id_timetable = b.id_departure_timetable
        ) zak ON zak.id_booking = bp.id_booking
        WHERE bp.id_place = ANY(id_place_arr)
)
SELECT array_agg(id_place) INTO boughtplace_ids FROM check_places;

    -- –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä–Ω—É–ª–∞ –∑–Ω–∞—á–µ–Ω–∏—è, –≤–µ—Ä–Ω—É—Ç—å -1
	IF boughtplace_ids IS NOT NULL THEN
    	RETURN QUERY
    	SELECT -1::bigint AS booking_id, unnest(boughtplace_ids) AS boughtplace_id;
		RETURN;
	END IF;


    -- –í—ã–ø–æ–ª–Ω—è–µ–º insert_booking –∏ –ø–æ–ª—É—á–∞–µ–º id_booking
    booking_id := insert_booking(id_client, id_arrival_timetable, id_departure_timetable);

    -- –í—ã–ø–æ–ª–Ω—è–µ–º insert_boughtplace –∏ –ø–æ–ª—É—á–∞–µ–º id_boughtplace
    boughtplace_ids := ARRAY(Select * from insert_boughtplace(booking_id, id_place_arr));

    -- –í—ã–ø–æ–ª–Ω—è–µ–º insert_booking_person
    PERFORM insert_booking_person(booking_id, id_person);

    -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è id_boughtplace
	temp_booking_id := booking_id;
    RETURN QUERY
    SELECT temp_booking_id, unnest(boughtplace_ids) AS boughtplace_id;
	RETURN;
END;
$$;
```
–ù–æ —Ç–∞–∫ –∂–µ –º–Ω–µ __–∫–∞–∂–µ—Ç—Å—è__, —á—Ç–æ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –ª–æ–≥–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–µ –≤ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –ë–î.
–ê –∏–º–µ–Ω–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º —Å–∏—Ç—É–∞—Ü–∏—é:  
–î–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è "–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ" –Ω–∞—á–∞–ª–∏ –ø–æ–∫—É–ø–∞—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –º–µ—Å—Ç–æ.
–û–±–∞ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Ç–æ —á—Ç–æ –º–µ—Å—Ç–æ –Ω–µ –∑–∞–Ω—è—Ç–æ. 
–ü–æ—Ç–æ–º—É —á—Ç–æ –ø–µ—Ä–≤—ã–π –∏–ª–∏ –≤—Ç–æ—Ä–æ–π –∫–ª–∏–µ–Ω—Ç –µ—â—ë –Ω–µ —É—Å–ø–µ–ª –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã.  

–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è:  
1. –°–¥–µ–ª–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–æ–ø—É—Å—Ç–∏–º –≤ —Ç–∞–±–ª–∏—Ü–µ "–ö—É–ø–ª–µ–Ω–Ω—ã–µ –±–∏–ª–µ—Ç—ã" –Ω–µ–ª—å–∑—è. 
–¢–∞–∫ –∫–∞–∫ –º–µ—Å—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫—É–ø–ª–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∑–∞ –º–∞—Ä—à—Ä—É—Ç 
(–æ–¥–∏–Ω –ø–∞—Å—Å–∞–∂–∏—Ä —Å–µ–ª –∏ –¥–æ–µ—Ö–∞–ª –∏–∑ –ê–Ω–∞–ø—ã –≤ –õ–∏–ø–µ—Ü–∫, –∞ –≤—Ç–æ—Ä–æ–π —Å–µ–ª –≤ –õ–∏–ø–µ—Ü–∫–µ –∏ –¥–æ–µ—Ö–∞–ª –¥–æ –ü–∏—Ç–µ—Ä–∞. 
–í—Å–µ —ç—Ç–æ –æ–¥–∏–Ω –º–∞—Ä—à—Ä—É—Ç –ê–Ω–∞–ø–∞-–ü–∏—Ç–µ—Ä —Å –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ –º–µ—Å—Ç–æ–º).  
2. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ –æ–±—ä–µ–¥–∏–Ω—è—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏,
–Ω–æ —è –Ω–µ –∑–Ω–∞—é –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ —ç—Ç–æ –±—É–¥–µ—Ç –∑–∞–º–µ–¥–ª—è—Ç—å —Ä–∞–±–æ—Ç—É –°–£–ë–î –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö —Å —Ä–µ–∞–ª—å–Ω—ã–º –æ–±—ä—ë–º–æ–º –¥–∞–Ω–Ω—ã—Ö.  
3. –¢–∞–∫ –∂–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –∏–ª–∏ —Å–≤—è–∑—å.  
–ù–æ –µ—Å—Ç—å –æ—â—É—â–µ–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ –≤—Å—ë –ø–æ–ø—ã—Ç–∫–∏ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Å—Ç—ã–ª—å –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ë–î.

–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤–Ω–∏–∫–ª–∏ üòä.

